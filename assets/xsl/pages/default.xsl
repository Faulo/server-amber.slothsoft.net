<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="1.0" xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"	xmlns:sfm="http://schema.slothsoft.net/farah/module" xmlns:sfs="http://schema.slothsoft.net/farah/sitemap" xmlns:php="http://php.net/xsl" extension-element-prefixes="php">	<xsl:import href="farah://slothsoft@farah/xsl/module" />	<xsl:template match="/*">		<xsl:variable name="currentPage" select="*[@name = 'sites']//*[@current]" />		<xsl:variable name="pageHierarchy" select="$currentPage/ancestor::sfs:*" />		<xsl:text disable-output-escaping='yes'>&lt;!DOCTYPE html&gt;</xsl:text>		<html>			<head>				<title>					<xsl:apply-templates select="$currentPage" mode="page-title" />					<xsl:for-each select="$pageHierarchy">						<xsl:sort select="position()" order="descending" />						<xsl:text> - </xsl:text>						<xsl:apply-templates select="." mode="page-title" />					</xsl:for-each>				</title>				<link rel="icon" type="image/png" href="/slothsoft@amber.slothsoft.net/static/icons/Ambermoon" />				<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />				<meta name="author" content="Daniel Schulz" />			</head>			<body>				<header>					<h1>						<xsl:if test="$pageHierarchy">							<small class="breadcrumb">								<xsl:for-each select="$pageHierarchy">									<xsl:apply-templates select="." mode="page-link" />									<xsl:text> Â» </xsl:text>								</xsl:for-each>							</small>						</xsl:if>						<xsl:apply-templates select="$currentPage" mode="page-link" />					</h1>				</header>				<main>					<span data-dict=".">						page/						<xsl:value-of select="$currentPage/@name" />						/about					</span>					<xsl:copy-of select="*[@name='content']/*" />					<h2>Portraits</h2>					<xsl:call-template name="resource-image">						<xsl:with-param name="archive" select="'Portraits.amb'" />					</xsl:call-template>					<h2>Items</h2>					<xsl:call-template name="resource-image">						<xsl:with-param name="archive" select="'Object_icons'" />					</xsl:call-template>					<h2>Combat Backgrounds</h2>					<xsl:apply-templates select="." mode="resource-images">						<xsl:with-param name="archive" select="'Combat_background.amb'" />					</xsl:apply-templates>					<h2>Events</h2>					<xsl:apply-templates select="." mode="resource-images">						<xsl:with-param name="archive" select="'Event_pix.amb'" />					</xsl:apply-templates>					<h2>Monsters</h2>					<xsl:apply-templates select="." mode="resource-images">						<xsl:with-param name="archive" select="'Monster_gfx.amb'" />					</xsl:apply-templates>				</main>			</body>		</html>	</xsl:template>	<xsl:template match="*" mode="resource-images">		<xsl:param name="archive" />		<xsl:param name="palette" select="1" />		<xsl:call-template name="resource-image">			<xsl:with-param name="archive" select="$archive" />			<xsl:with-param name="palette" select="$palette" />		</xsl:call-template>		<xsl:if test="$palette &lt; 49">			<xsl:apply-templates select="." mode="resource-images">				<xsl:with-param name="archive" select="$archive" />				<xsl:with-param name="palette" select="$palette +1" />			</xsl:apply-templates>		</xsl:if>	</xsl:template>	<xsl:template name="resource-image">		<xsl:param name="archive" />		<xsl:param name="palette" select="49" />		<xsl:variable name="url" select="concat('/slothsoft@amber/game-resources/gfx?archiveId=', $archive, '&amp;paletteId=', $palette)" />		<a href="{$url}" class="resource">			<img src="{$url}" />		</a>	</xsl:template>	<xsl:template match="*" mode="page-link">		<a href="{@uri}">			<xsl:apply-templates select="." mode="page-title" />		</a>	</xsl:template>	<xsl:template match="*" mode="page-title">		<span data-dict=".">			page/			<xsl:value-of select="@name" />			/title		</span>	</xsl:template></xsl:stylesheet>